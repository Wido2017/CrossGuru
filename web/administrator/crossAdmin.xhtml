<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <title>管理</title>
        <link rel="stylesheet" href="../resources/css/amazeui.css" />
        <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"/>
        <link rel="stylesheet" href="../resources/css/core.css" />
        <link rel="stylesheet" href="../resources/css/menu.css" />
        <link rel="stylesheet" href="../resources/css/index.css" />
        <link rel="stylesheet" href="../resources/css/admin.css" />
        <link rel="stylesheet" href="../resources/css/typography.css" />
        <link rel="stylesheet" href="../resources/css/form.css" />
        <!--        <link rel="stylesheet" href="../resources/css/home.css" />-->

    </h:head>
    <h:body>
        <!-- Begin page -->
        <header class="am-topbar am-topbar-fixed-top">      
            <div class="contain2">
                <ul class="am-nav am-navbar-nav am-navbar-left">
                </ul>
                <ul class="am-nav am-navbar-nav am-navbar-right">
                   
                    <li>
                        <p:button value="注销" href="../home.xhtml"></p:button>
                    </li>
                </ul>
            </div>
        </header>
        <!-- end page -->
        <div class="admin">
            <p:layoutUnit position="left" style="border-right-width: 6px;width:20%;background-color: #E4E4E4" size="200px" resizable="false" gutter="0">
                <!-- User -->
                <div class="am-offcanvas-bar admin-offcanvas-bar">
                    <div class="user-box am-hide-sm-only">
                        <a class="logo"><span>Admin<span>to</span></span><i class="zmdi zmdi-layers"></i></a>

                        <div style="width:88px;height:88px;margin-left: 30%">
                            <img src="../resources/images/鲸鱼.jpg" alt="user-img" title="Mat Helme" class="img-circle img-thumbnail img-responsive"/>
                            <div class="user-status offline"><i class="am-icon-dot-circle-o" aria-hidden="true"></i></div>
                        </div>
                        <h5><a href="#">
                                <h:outputText value="ID: #{loginManger.loginAdministrator.id}"></h:outputText>
                                <br/>
                                <h:outputText value="姓名: #{loginManger.loginAdministrator.name}"></h:outputText>
                            </a> </h5>
                        <ul class="list-inline">
                            <li>
                                <a href="#">
                                    <i class="fa fa-cog" aria-hidden="true"></i>
                                </a>
                            </li>

                            <li>
                                <a href="#" class="text-custom">
                                    <i class="fa fa-cog" aria-hidden="true"></i>
                                </a>
                            </li>
                        </ul>
                    </div>



                    <ul class="am-list admin-sidebar-list">
                        <li><a href="userAdmin.xhtml" class="atext">用户管理</a></li>
                        <li><a href="crossAdmin.xhtml" class="atext">路口管理</a></li>
                    </ul>
                </div>

            </p:layoutUnit>        


            <!-- Start right Content here -->
            <div class="content-page">
                <!-- Start content -->
                <div class="content">
                    <div class="card-box">
                        <!-- Row start -->
                        <div class="am-g">

                            <!--container start-->
                            <div class="am-u-sm-12 am-u-md-6">
                                <h:form id="AreaDTForm">
                                    <div class="am-btn-toolbar">
                                        <div class="am-btn-group am-btn-group-xs">
                                            <h4 class="page-title">路口管理</h4>

                                            <p:growl id="messages" showDetail="true" />

                                            <p:toolbar style="width: 1000px;">
                                                <f:facet name="left">
                                                    <p:commandButton id="createButton" icon="ui-icon-plus"   value="新增" actionListener="#{areaController.prepareCreate}" update=":AreaCreateForm" oncomplete="PF('AreaCreateDialog').show()"/>
                                                    <p:commandButton id="deleteButton" icon="ui-icon-trash"   value="删除" actionListener="#{crossManager.deleteSelectArea}" update=":AreaDTForm:areaTable :AreaDTForm:deleteButton" disabled="#{crossManager.selectedArea==null}">
                                                        <p:confirm header="提示" message="确定删除吗?" icon="ui-icon-alert" />
                                                    </p:commandButton>
                                                    <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                                                        <p:commandButton value="是" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                                                        <p:commandButton value="否" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                                                    </p:confirmDialog>
                                                </f:facet>
                                            </p:toolbar>

                                        </div>
                                    </div>


                                    <p:panel header="区域" style="width: 1000px;">
                                        <p:dataTable id="areaTable" value="#{crossManager.areas}" var="item" widgetVar="areaTable"
                                                     selectionMode="single" selection="#{crossManager.selectedArea}"
                                                     rowKey="#{item.id}"
                                                     rows="10"
                                                     paginator="true"
                                                     paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                                     >
                                            <p:column filterBy="#{item.id}" headerText="区域ID" filterMatchMode="contains">
                                                <h:outputText value="#{item.id}" />
                                            </p:column>
                                            <p:column filterBy="#{item.name}" headerText="区域名" filterMatchMode="contains">
                                                <h:outputText value="#{item.name}" />
                                            </p:column>
                                            <p:column filterBy="#{item.location}" headerText="位置" filterMatchMode="contains">
                                                <h:outputText value="#{item.location}" />
                                            </p:column>

                                            <p:ajax event="rowSelect" listener="#{crossManager.onRowSelect}" update=":AreaDTForm:areaDetailForm:areaDetail,:AreaDTForm:messages,:AreaDTForm:deleteButton" onsuccess="PF('areaDialog').show()" />
                                        </p:dataTable>
                                    </p:panel>
                                    <p:dialog header="区域信息" widgetVar="areaDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false" >
                                        <h:form id="areaDetailForm">
                                            <p:panel id="areaDetail" style="text-align:center;width: 1000px;">
                                                <p:dataTable id="crossingTable" value="#{crossManager.areaHasCrossings}" var="crossings" widgetVar="crossingTable"
                                                             selectionMode="single" selection="#{crossManager.selectedCrossing}"
                                                             rowKey="#{crossings.id}"
                                                             rows="10"
                                                             paginator="true"
                                                             paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                                             >
                                                    <p:column headerText="路口ID">
                                                        <h:outputText value="#{crossings.id}" />
                                                    </p:column>
                                                    <p:column headerText="路口名">
                                                        <h:outputText value="#{crossings.location}" />
                                                    </p:column>
                                                    <p:ajax event="rowSelect" listener="#{crossManager.onRowSelectCrossing}" update=":AreaDTForm:messages :CrossingInfoForm:CrossingDisplay :AreaDTForm:areaDetailForm:crossingDeleteButton" onsuccess="PF('CrossingInfoDialog').show()"/>
                                                </p:dataTable>
                                                <f:facet name="footer">
                                                    <p:commandButton id="crossingCreateButton" icon="ui-icon-plus" value="新增"  actionListener="#{crossManager.onClickCreateButton}"  update=":CrossingCreateForm:CrossingCreateDisplay" oncomplete="PF('CrossingCreateDialog').show()" />
                                                    <p:commandButton id="crossingDeleteButton" icon="ui-icon-trash"   value="删除" actionListener="#{crossManager.deleteSelectCrossing}" update=":AreaDTForm:areaDetailForm:crossingTable crossingDeleteButton" disabled="#{crossManager.selectedCrossing==null}">
                                                        <p:confirm header="提示" message="确定删除吗?" icon="ui-icon-alert" />
                                                    </p:commandButton>
                                                    <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                                                        <p:commandButton value="是" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                                                        <p:commandButton value="否" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                                                    </p:confirmDialog>
                                                </f:facet>
                                            </p:panel>
                                        </h:form>
                                    </p:dialog>


                                </h:form>
                                <p:dialog id="AreaCreateDlg" widgetVar="AreaCreateDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false" header="新建区域">
                                    <h:form id="AreaCreateForm">
                                        <h:panelGroup id="display">
                                            <p:panelGrid columns="2" rendered="#{areaController.selected != null}">
                                                <p:outputLabel value="区域id" for="id" />
                                                <p:inputText id="id" value="#{areaController.selected.id}" title="#{bundle.CreateAreaTitle_id}" required="true" requiredMessage="#{bundle.CreateAreaRequiredMessage_id}"/>
                                                <p:outputLabel value="区域名" for="name" />
                                                <p:inputText id="name" value="#{areaController.selected.name}" title="#{bundle.CreateAreaTitle_name}" required="true" requiredMessage="#{bundle.CreateAreaRequiredMessage_name}"/>
                                                <p:outputLabel value="位置" for="location" />
                                                <p:inputText id="location" value="#{areaController.selected.location}" title="#{bundle.CreateAreaTitle_location}" required="true" requiredMessage="#{bundle.CreateAreaRequiredMessage_location}"/>
                                            </p:panelGrid>
                                            <p:commandButton actionListener="#{areaController.create}" value="确认" update="display,:AreaDTForm:areaTable,:AreaDTForm:messages" oncomplete="handleSubmit(args,'AreaCreateDialog');"/>
                                            <p:commandButton value="取消" onclick="AreaCreateDialog.hide()"/>
                                        </h:panelGroup>
                                    </h:form>
                                </p:dialog>
                                <p:dialog id="CrossingInfoDlg" widgetVar="CrossingInfoDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false" header="路口信息">
                                    <h:form id="CrossingInfoForm">
                                        <h:panelGroup id="CrossingDisplay">
                                            <p:panelGrid columns="2" rendered="#{crossManager.selectedCrossing != null}">
                                                <p:outputLabel value="路口id"/>
                                                <h:outputText value="#{crossManager.selectedCrossing.id}" />
                                                <p:outputLabel value="路口名"/>
                                                <h:outputText value="#{crossManager.selectedCrossing.location}" />
                                                <p:outputLabel value="摄像头_W"/>
                                                <p:inputText id="camera_id_w" value="#{crossManager.selectedCrossing.cameraidW}"/>
                                                <p:outputLabel value="摄像头_S"/>
                                                <p:inputText id="camera_id_s" value="#{crossManager.selectedCrossing.cameraidS}"/>
                                                <p:outputLabel value="摄像头_N"/>
                                                <p:inputText id="camera_id_n" value="#{crossManager.selectedCrossing.cameraidN}"/>
                                                <p:outputLabel value="摄像头_E"/>
                                                <p:inputText id="camera_id_e" value="#{crossManager.selectedCrossing.cameraidE}"/>
                                                <p:outputLabel value="红绿灯_W"/>
                                                <p:inputText id="trafficLight_id_w" value="#{crossManager.selectedCrossing.trafficLightidW}"/>
                                                <p:outputLabel value="红绿灯_S"/>
                                                <p:inputText id="trafficLight_id_s" value="#{crossManager.selectedCrossing.trafficLightidS}"/>
                                                <p:outputLabel value="红绿灯_N"/>
                                                <p:inputText id="trafficLight_id_n" value="#{crossManager.selectedCrossing.trafficLightidN}"/>
                                                <p:outputLabel value="红绿灯_E"/>
                                                <p:inputText id="trafficLight_id_e" value="#{crossManager.selectedCrossing.trafficLightidE}"/>
                                            </p:panelGrid>
                                        </h:panelGroup>
                                        <p:commandButton id="saveButton" value="保存" actionListener="#{crossManager.updateSelectCrossing}" update="CrossingDisplay :AreaDTForm:messages"/>
                                    </h:form>
                                </p:dialog>
                                <p:dialog id="CrossingCreateDlg" widgetVar="CrossingCreateDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false" header="新建路口">
                                    <h:form id="CrossingCreateForm">
                                        <h:panelGroup id="CrossingCreateDisplay">
                                            <p:panelGrid columns="2" rendered="#{crossManager.selectedArea != null}">
                                                <p:outputLabel value="路口id"/>
                                                <p:inputText value="#{crossManager.selectedCrossing.id}" />
                                                <p:outputLabel value="路口名"/>
                                                <p:inputText value="#{crossManager.selectedCrossing.location}" />
                                                <p:outputLabel value="摄像头_W"/>
                                                <p:inputText id="camera_id_w" value="#{crossManager.selectedCrossing.cameraidW}"/>
                                                <p:outputLabel value="摄像头_S"/>
                                                <p:inputText id="camera_id_s" value="#{crossManager.selectedCrossing.cameraidS}"/>
                                                <p:outputLabel value="摄像头_N"/>
                                                <p:inputText id="camera_id_n" value="#{crossManager.selectedCrossing.cameraidN}"/>
                                                <p:outputLabel value="摄像头_E"/>
                                                <p:inputText id="camera_id_e" value="#{crossManager.selectedCrossing.cameraidE}"/>
                                                <p:outputLabel value="红绿灯_W"/>
                                                <p:inputText id="trafficLight_id_w" value="#{crossManager.selectedCrossing.trafficLightidW}"/>
                                                <p:outputLabel value="红绿灯_S"/>
                                                <p:inputText id="trafficLight_id_s" value="#{crossManager.selectedCrossing.trafficLightidS}"/>
                                                <p:outputLabel value="红绿灯_N"/>
                                                <p:inputText id="trafficLight_id_n" value="#{crossManager.selectedCrossing.trafficLightidN}"/>
                                                <p:outputLabel value="红绿灯_E"/>
                                                <p:inputText id="trafficLight_id_e" value="#{crossManager.selectedCrossing.trafficLightidE}"/>
                                            </p:panelGrid>
                                            <p:commandButton actionListener="#{crossManager.createNewCrossing}" value="确认" update="CrossingCreateDisplay :AreaDTForm:areaDetailForm:areaDetail :AreaDTForm:messages"/>

                                        </h:panelGroup>
                                    </h:form>
                                </p:dialog>
                            </div>  
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </h:body>

</html>
